#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









#set($isEditable = true)

$cms.template("Top")

<div class="customerBodyWrapper">

	<div class="customerWide">
	#if($wma.isVmsOutage())
		<div id="vms_status"><strong><font color="red">VMS Health check failed and the VMS service is down.</font></strong></div><br><br>
	#else
		<div id="vms_status"><strong><font color="green">VMS service is available.</font></strong></div><br><br>
	#end
	Last Visit: $util.date("MM/dd/yyyy 'at' hh:mm:ss z", $wma.lastVisitDate)<br>
	<a href="/en/vm">Refresh Page</a><br><br>


<script type="text/javascript">
var deleteCookie = function(name, path, domain) {  
	document.cookie = name + "=" +
   ( (path) ? ";path=" + path : "") +
   ( (domain) ? ";domain=" + domain : "") +
   ";expires=Thu, 01-Jan-1970 00:00:01 GMT;" } 
var deleteCookies = function() {
   deleteCookie("vmSessionId", "/", ".$cms.domain");
   deleteCookie("UID", "/", ".$cms.domain");
	window.location.reload(true);  } 
   </script>
 
<input type="button" id="clear-vm-cookies" value="Clear VM Cookies" onclick="deleteCookies()"/>
<p>
<div id="vmSessionId">vmSessionId: $userRequest.getCookie("vmSessionId")</div><br>
<div id="UID">UID: $userRequest.getCookie("UID")</div><br>
<div id="click_mobile">click_mobile: $userRequest.getCookie("click_mobile")</div><br>
</p>
<p>
Method: $req.header("method")
</p>
	#foreach($field in $wma.profileFields) 
		#if($req.param("field_${field.tag}").length() > 0)
		$codeDebug.log("Setting Profile Field (wma.profile.setStringValue($field.tag, $req.param('field_${field.tag}'))). Setting field $field.tag to $req.param('field_${field.tag}')")
		<br><b>Setting Profile Field (\$wma.profile.setStringValue($field.tag, $req.param("field_${field.tag}"))):</b><br><br>
		Setting field $field.tag to $req.param("field_${field.tag}") <br>
			#if($field.dataType == "text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Long Text")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "E-mail")
				$wma.profile.setStringValue($field.tag,$req.param("field_${field.tag}"))
				#elseif($field.dataType == "Number")
				$wma.profile.setLongValue($field.tag,$req.longParam("field_${field.tag}"))
				#elseif($field.dataType == "Date")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Date/Time")
				$wma.profile.setDateValue($field.tag,$req.dateParam("field_${field.tag}","yyyy-MM-dd'T'HH:mm:ss",$wma.getTimeZone().getID()))
				#elseif($field.dataType == "Flag")
				$wma.profile.setBooleanValue($field.tag,$req.booleanParam("field_${field.tag}"))
			#end
		#end
	#end
	#if($req.param("ls").length() > 0)
	<br>Setting Lead Score: wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))<br>
	#end
	</div><br>
	#if((!$wma.isRegistered() || ($wma.isRegistered() && $wma.isLoggedIn())) && (!$req.param("login") || $req.param("login") != "y") || ((!$req.param("signup") || $req.param("signup") == "y")))
		#set($user = $wma.profile)
		<div class="customerWide">
		##DEBUG: $wma.profile.getField("firstname").value OR $wma.profile.firstname, $wma.profile.getField("lastname") OR $wma.profile.lastname, $wma.profile.getField("password").value (CMP-7747)<br>
		#########################################
		### Start Registration Form
		#########################################
		#if($subscription.error)
		<div class="subscriptionError">
		DefaultMsg:<font color="red">$!subscription.errorMessage</font>
		</div>
		<div class="subscriptionError">
		ErrorCode:<font color="red">$!subscription.errorCode</font>
		</div>
		<div class="subscriptionError">
		ErrorDetails:<font color="red">$!subscription.errorDetails</font>
		</div><br>
		#end
		#############################
		#* test form
		<form name="profileForm" method="post" action="/s">
		<input type="hidden" name="action" value="doReg" />
       #set($profileList=$wma.profileFields)
       #foreach($field in $profileList)
			 #if($string.indexOf($field.dataType, "date") != -1)
				<tr><td>$field.label : </td><td><input type="date" name="$field.tag"/></td></tr>
			#elseif($string.indexOf($field.dataType, "number") != -1)
				<tr><td>$field.label : </td><td><input type="integer" name="$field.tag"/></td></tr>
			#elseif($field.fieldType == "select")
				<tr><td>$field.label : </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#else
				<tr><td>$field.label : </td><td><input type="text" name="$field.tag"/></td></tr>
			#end
       #end
      <input type="submit"/>
		</form>
		*#
		#############################
		
		
		#if($userLocation.isAvailable())
			#if($wma.profile.city)
				#set($city = $wma.profile.city)
			#else
				#set($city = $userLocation.city)
			#end
			#if($wma.profile.country)
				#set($country = $wma.profile.country)
			#else
				#set($country = $userLocation.country)
			#end
			#if($wma.profile.company)
				#set($company = $wma.profile.company)
			#else
				#set($company = $userLocation.organization)
			#end
			#if($wma.profile.state)
				#set($state = $wma.profile.state)
			#else
				#set($state = $userLocation.region)
			#end
			#if($wma.profile.areaCode)
				#set($phone = "${wma.profile.areacode}-")
			#else
				#set($phone = "${userLocation.areacode}-")
			#end
		#end

		<script type="text/javascript">
		<!--
		function validate(form) {
			var e = form.elements;
			if(e['email'].value == '') {
				alert('Please Enter Your Email Address');
				e['email'].focus();
				return false;
			}
			if(e['confirm_email'].value == '') {
				alert('Please Confirm Your Email Address');
				e['confirm_email'].focus();
				return false;
			}
			if(e['email'].value != e['confirm_email'].value) {
				alert('Your Email Addresses Do Not Match');
				e['confirm_email'].focus();
				return false;
			}
			if(e['username'].value == '') {
				alert('Please Enter Your Login/User Name');
				e['username'].focus();
				return false;
			}
			if(e['password1'].value == '') {
				alert('Please Enter Your Password');
				e['password1'].focus();
				return false;
			}
			if(e['password2'].value == '') {
				alert('Please Retype Your Password');
				e['password2'].focus();
				return false;
			}
			if(e['password1'].value != e['password2'].value) {
				alert('Your Passwords Do Not Match');
				e['password1'].focus();
				return false;
			}
			}
		-->
		</script>
		
		<form method="post" action="/s" name="userProfileForm" id="userProfileForm" onsubmit="return validate(this);" enctype="multipart/form-data">
			#if($wma.isLoggedIn())
				<input type="hidden" name="action" value="updateReg" />
				#set($changeStatus = "update")
			#else
				<input type="hidden" name="action" value="doReg" />
				#set($changeStatus = "create")
			#end
			<input type="hidden" name="city" value="$!city" />
			<input type="hidden" name="country" value="$!country" />
			<input type="hidden" name="company" value="$!organization" />
			<input type="hidden" name="state" value="$!state" />
			<input type="hidden" name="areacode" value="$!areaCode" />
			<input type="hidden" name="rurl" value="/en/vm" />
			#if($wma.isLoggedIn())
				Registration Information<br>
				<a href="/s?action=editPassword">Click to change Password.</a><br>
			#else
				Sign Up Now!<br>
				or <a href="/s?action=doLogin">Login</a><br>
			#end
			<p>
			#if($req.param("fields") && $req.param("fields") == "y" )
				#set($profileList=$wma.profileFields)
				#if($wma.isLoggedIn())
					#set($user = $wma.profile) 
				#end
				<table>
				#foreach($field in $profileList)
					#set($fieldTag = $field.tag)
					 #if($field.fieldType == "select")
						<tr><td>$field.label : </td><td><select name="$fieldTag"/>
						#foreach($option in $field.options)
							<option value="$option.value" #if($user && "$option.value" == "$!user.get($fieldTag)") selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "multiSelect")
						<tr><td>$field.label : </td><td><select multiple name="$field.tag" />
						#foreach($option in $field.options)
							<option value="$option.value"  #if($user && $user.get($fieldTag).contains($option.value)) selected #end>$option.label</option>
						#end
						</select>
						</td></tr>
					#elseif($field.fieldType == "password")
						#if(!$wma.isLoggedIn())
						<tr><td>$field.label : </td><td><input type="password" name="$fieldTag" /></td></tr>
						#end
					#elseif($field.dataType == "date")
						<tr><td>
						#if($user)
							#set($date = $!user.getField(${field.tag}).value)
						#end
						$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!util.date('yyyy-MM-dd', $date)" #end/></td></tr>
					#else
						<tr><td>$field.label : </td><td><input type="text" name="$fieldTag" #if($user) value="$!user.getField(${field.tag})" #end /></td></tr>
					#end
				#end
				</table>
			#else
				<p>
				<label for="firstname"><span class="bold">First Name:</span><br>
					<input type="text" name="firstname" id="firstname" size="50" maxlength="128" #if($wma.profile.firstname) value="$wma.profile.getField('firstname').value" #else value='$!req.param("firstname")' #end>
				</label>
				</p>
				<p>
				<label for="lastname"><span class="bold">Last Name:</span><br>
					<input type="text" name="lastname" id="lastname" size="50" maxlength="128" #if($wma.profile.lastname) value="$wma.profile.getField('lastname').value" #else value='$!req.param("lastname")' #end>
				</label>
				</p>
				<p>
				<label for="user_name"><span class="bold">* User Name:</span><br>
					 <input type="text" name="username" id="username" size="50" maxlength="128" #if($wma.profile.username) value="$wma.profile.getField('username').value" #else value='$!req.param("username")' #end> 
				</label>
				</p>
				<p>
				DEBUG: $cms.subscriptionUser.email (reguser), $wma.profile.email (wma)<br>
				<label for="email"><span class="bold">* Login/Email Address:</span><br>
					<input type="text" name="email" id="email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
				</label>
				</p>
				<p>
				#if(!$wma.isLoggedIn())
					<label for="confirm_email"><span class="bold">* Confirm Email:</span><br>
						<input type="text" name="confirm_email" id="confirm_email" size="50" maxlength="128" #if($wma.profile.email) value="$wma.profile.getField('email').value" #else value='$!req.param("email")' #end>
					</label>
				</p>
				#end
				#if(!$wma.isLoggedIn())
					#if($req.param("showpass") && $req.param("showpass") == "y")
					<p>
						<label for="password"><span class="bold">* Password:</span><br>
							<input type="password" name="password" id="password" size="50" maxlength="128" #if($req.param("password")) value='$!req.param("password")' #end>
						</label>
					</p>
		
					<p>
						<label for="confirm_password"><span class="bold">* Retype Password:</span><br>
							<input type="password" name="confirm_password" id="confirm_password" size="50" maxlength="128" #if($req.param("confirm_password")) value='$!req.param("confirm_password")' #end>
						</label>
					</p>
					#end
				<p>
					<label for="password1"><span class="bold">* Password1:</span><br>
						<input type="password" name="password1" id="password1" size="50" maxlength="128" #if($req.param("password1")) value='$!req.param("password1")' #end>
					</label>
				</p>
				<p>
					<label for="password2"><span class="bold">* Password2:</span><br>
						<input type="password" name="password2" id="password2" size="50" maxlength="128" #if($req.param("password2")) value='$!req.param("password2")' #end>
					</label>
				</p>
				#end
				<p>
					<input name="list.4694" id="taborResearch"  type="checkbox" #if($wma.subscribedTo(4694) || $req.param("list.4694") == "subscribe")checked value="subscribed" #else value="subscribe" #end>
					<input name="listInit.4694" #if($wma.subscribedTo(4694)) value="subscribed"#else value="unsubscribed"#end type="hidden"> Sign up for Animal Updates!
				</p>
			#end
			
			#if($wma.isLoggedIn())
			<input type="submit" name="submit" id="submit" value="Update Profile">
			#else
			<input type="submit" name="submit" id="submit" value="Submit">
			#end
		</form>
		</div><br><br>
	#########################################
	## End Registration Form
	#########################################
	#elseif(($wma.isRegistered() && !$wma.isLoggedIn()) || $req.param("login") == "y")
	<p>
		I see you are already registered, but if you want to show the signup form, add "signup=y" as a URL param.
	</p>
	<div class="customerWide">
	Login Here:<br>
		<form name="login" method="post" action="/s">
		<input type="hidden" name="action" value="doLogin" />
		<input type="hidden" name="rurl" value="/en/vm" />
		<div class="block">
		<table>
		<tr>
		<td>Email:</td>
		<td><input type="text" name="email" id="emailInput" /></td>
		</tr>
		<tr>
		<td>Password:</td>
		<td><input type="password" name="password" /></td>
		</tr>
		</table>
		<input type="submit" value="login"/>
		</div>
		</form> <br>
	</div>
	#end
	<div class="customerWide">
		#if($wma.isLoggedIn())
			<a href="/s?action=doLogout">Logout Here</a><br>
		#end
		<div id="login_status">Is Logged In (\$wma.isLoggedIn()): $wma.isLoggedIn()</div><br>
		<div id="reg_status">Is Registered (\$wma.isRegistered()): $wma.isRegistered()</div><br>
	</div>

	<div class="customerWide">
		<br><b>Visitor Data</b><br>
		<div id="lead_score">Lead Score (\$wma.getLeadScore()): $wma.getLeadScore()</div><br>

		#set($level = $wma.profileLevel)
		<div id="profile_level">Profile Level (\$wma.profileLevel): #if($level) $level.level - $level.name - $level.scoreTrigger #else None #end </div><br>
		<div id="page_views">Page View Count (\$wma.pageViewCount): $wma.pageViewCount</div><br>
		<div id="visit_count">Visit Count (\$wma.visitCount): $wma.visitCount</div><br>
		<div id="search_count">Search Count (\$wma.searchCount): $wma.searchCount</div><br>
		<div id="visitor_state">Visitor State(\$wma.state): $wma.state</div><br>
		isMarketingActivityBlocked(\$wma.isMarketingActivityBlocked()): $wma.isMarketingActivityBlocked()<br>
		Date of First activity(\$wma.firstActivity): $wma.firstActivity<br>
		RegUserID(\$wma.registeredUserId): $wma.registeredUserId<br>
		Timezone (\$wma.timeZone): $wma.timeZone<br>
		<br><b>Visitor Actions</b><br>
		#foreach($action in $wma.actionDefinitions)
			<b>$action.name ($action.tag) Count: $wma.getVisitorActionCount($action.tag) </b><br>	
			#foreach($visitorAction in $wma.getVisitorActionsByTagName($action.tag))
				- $action.name Date : $visitorAction.actionTime<br>
				- $action.name Description: $visitorAction.actionDescription<br><br>
			#end
		#end
		<div id="visitorid_10051">Visit 10051(\$wma.getVisitorId()): $wma.getVisitorId()</div><br>
		<div id="visitorid2_10051">Visitor 10051(\$wma.visitorId): $wma.visitorId</div><br>
		$wma.getVisitorId()
		$wma.visitorId
		$wma.getVisitor.getId() <br/>
		$wma.getVisitor().getId() <br/>
		$wma.profile.id <br/>
		$wma.profile.getId() <br/> 
		$wma.getId()  <br/>
		$wma.profile.getID() <br/> 
		$wma.profile.getVisitorId() <br/>  
		$wma.profile.getVisitorID()<br><br/><br/>

	</div>

	<div class="customerWide">
		<br><b>Lead Score (\$wma.leadScore): $wma.leadScore </b><br>
		
		Adjustments (\$wma.leadScoreAdjustments):<br>
		#foreach($adj in $wma.leadScoreAdjustments)
		#if($adj.increment)Inc #else Set #end $adj.amount at $adj.time - $adj.type - $adj.description <br>
		#end
	</div>

	<div class="customerWide">
		<br><b>Interest Definitions</b> (<a onclick='document.getElementById("interestDefs").style.display="block";'>show</a>)
		<div id="interestDefs" style="display: none;">
		<br>Interests (\$wma.interestDefinitions): <br>
		#foreach($interest in $wma.interestDefinitions)
			$interest.tag - $interest.name - Score: $!wma.getInterestScore($interest.tag)<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Action Definitions</b>  (<a onclick='document.getElementById("actionDefs").style.display="block";'>show</a>)
		<div id="actionDefs" style="display: none;">
		<br>Actions (\$wma.actionDefinitions): <br>
		#foreach($action in $wma.actionDefinitions)
		$action.tag - $action.name - $action.leadScoreAdjustment<br>
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Progressive Profile Levels</b>  (<a onclick='document.getElementById("ppls").style.display="block";'>show</a>)
		<div id="ppls" style="display: none;">
		<br>Levels (\$wma.getProfileLevels()): <br>
		#foreach($level in $wma.getProfileLevels())
		$level.level - $level.name - $level.scoreTrigger<br>
			#foreach($level in $level.fields)
				#if($velocityCount == 1)
					Assigned Fields -<br>
				#end
				-- $level.label - $level.tag<br>
			#end
		#end
		</div>
	</div>
	
	<div class="customerWide">
		<br><b>Fields </b>  (<a onclick='document.getElementById("fields").style.display="block";'>show</a>)
		<div id="fields" style="display: none;">
		<br>Fields (\$wma.getProfileFields()): <br>
		<table border=1>
		#foreach($field in $wma.getProfileFields())
			<tr>
			<td rowspan="8">$field.getLabel()</td>
			<td><b>getDataType()</b></td>
			<td>$!field.getDataType()</td>
			</tr>
			<tr>
			<td><b>getDefaultValue()</b></td>
			<td>#if($field.getDefaultValue()) $!field.getDefaultValue()  #else None #end</td>
			</tr>
			<tr>
			<td><b>getFieldType()</b></td>
			<td>$!field.getFieldType()</td>
			</tr>
			#if($field.fieldType == "select")
				<tr><td><b>--$field.label :</b> </td><td><select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select>
				</td></tr>
			#elseif($field.fieldType == "multiSelect")
				<tr><td><b>--$field.label :</b> </td><td><select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
			#else
				<tr><td></td><td></td></tr>
			#end
			<tr>
			<td><b>getLabel()</b></td>
			<td>$!field.getLabel()</td>
			</tr>
			<tr>
			<td><b>getLeadScoreContribution()</b></td>
			<td>$!field.getLeadScoreContribution()</td>
			</tr>
			<tr>
			<td><b>getProgressiveProfileLevel()</b></td>
			<td>$!field.getProgressiveProfileLevel()</td>
			</tr>
			<tr>
			<td><b>getTag()</b></td>
			<td>$!field.getTag()</td>
			</tr>
		#end
		</table>
		</div>

	</div>
	
	<div class="customerWide">
		#set($profile = $wma.profile)
		<br><b>Field Values (size == $profile.size())</b>  (<a onclick='document.getElementById("fieldValues").style.display="block";'>show</a>)
		<div id="fieldValues" style="display: none;">
		<br>Field Values (\$wma.profile.fields): <br>
		<table border=1>
		#foreach($field in $profile.fields)
		<tr>
		<td><b>dataType</b></td>
		<td>$!field.dataType</td>
		</tr>
		<tr>
		<td><b>defaultValue</b></td>
		<td>#if($field.defaultValue) $field.defaultValue  #else None #end</td>
		</tr>
		<tr>
		<td><b>fieldType</b></td>
		<td>$!field.fieldType</td>
		</tr>
		<tr>
		<td><b>label</b></td>
		<td>$!field.label</td>
		</tr>
		<tr>
		<td><b>leadScoreContribution</b></td>
		<td>$!field.leadScoreContribution</td>
		</tr>
		<tr>
		<td><b>progressiveProfileLevelId</b></td>
		<td>$!field.progressiveProfileLevelId</td>
		</tr>
		<tr>
		<td><b>tag</b></td>
		<td>$!field.tag</td>
		</tr>
		<tr>
		<td style="background-color:lightgreen"><b>value</b></td>
		<td style="background-color:lightgreen">$!field.value</td>
		</tr>
		#end
		</table>
		</div>
	</div>
	


</div>

<div id="tagForm" class="customerBodyWrapper">
	
	<form name="profileForm" method="get" action="/en/vm">

	<div class="customerWide">

		<br><b>Profile Form </b>  (<a onclick='document.getElementById("profileForm").style.display="block";'>show</a>)
		<div id="profileForm" style="display: none;">
		#if($subscription.error)
		<b> Error Info : $subscription.error</b>
			<table>			
			    <tr>
			        <td>errorCode: $subscription.errorCode </td>
			    </tr>
			    <tr>
			        <td>errorDetails: $subscription.errorDetails</td>
			    </tr>	
		</table>
		#end 
        	<input type="hidden" name="errorDestId" value="$cms.websiteSection.id" />
		#if($cms.content)
		        <input type="hidden" name="errorContentId" value="$cms.content" />
		#end 		
		#foreach($field in $wma.getProfileFields())
			<br><input onclick="$('field_${field.tag}').disabled = !(this.checked)" type="checkbox">
			$field.tag 
			#set($stringValue = "")
			#if($field.dataType.name == "Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Long Text")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "E-mail")
				#set($stringValue = $wma.profile.getValue($field.tag).value)
			#elseif($field.dataType.name == "Number")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#elseif($field.dataType.name == "Date")
				#set($stringValue = $util.date("yyyy-MM-dd",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Date/Time")
				#set($stringValue = $util.date("yyyy-MM-dd'T'HH:mm:ss",$wma.profile.getValue($field.tag).value,$wma.getTimeZone().getID()))
			#elseif($field.dataType.name == "Flag")
				#set($stringValue = $wma.profile.getValue($field.tag).value.toString())
			#end
			#if($field.fieldType == "select")
				<select name="$field.tag"/>
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#elseif($field.fieldType == "multiSelect")
				<select multiple name="$field.tag" />
				#foreach($option in $field.options)
					<option value="$option.value">$option.label</option>
				#end
				</select><br>
			#else
				<input value="$stringValue" name="field_${field.tag}" id="field_${field.tag}" disabled="disabled" type="text">
				<br>
			#end
		#end
		<input value="submit" type="submit">

		</div>
	</div>
	#* Hiding CSRF Token validation since it's disabled for testing.
	<div class="customerWide">
	<input type="text" name="csrf" value='$cms.generateCsrfToken("subscriber")' />
	</div>
	*#
	<div class="customerWide">
		#if($req.param("lsAdj").length() > 0)
		$wma.adjustLeadScore($req.intParam("lsAdj"),$req.param("lsAdjDesc"))
		#end
		<h4>adjustLeadScore(int adjustment, String description)</h4>
		<input onclick="$('lsAdj').disabled = !(this.checked); $('lsAdjDesc').disabled = !(this.checked)" type="checkbox">
		Adjustment: <input name="lsAdj" id="lsAdj" value="5" disabled="disabled" type="text">

		Desc: <input name="lsAdjDesc" id="lsAdjDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("ls").length() > 0)
			$wma.setLeadScore($req.intParam("ls"),$req.param("setLsDesc"))
			$codeDebug.log("Setting Lead Score: wma.setLeadScore($req.intParam('ls'),$req.param('setLsDesc'))")
		#end
		<h4>setLeadScore(int adjustment, String description)</h4>
		<input onclick="$('ls').disabled = !(this.checked);$('setLsDesc').disabled = !(this.checked)" type="checkbox">

		Adjustment: <input name="ls" id="ls" value="5" disabled="disabled" type="text">
		Desc: <input name="setLsDesc" id="setLsDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
	#if($req.param("trackInterestTag").length() > 0)
			Tracking Interest: $req.param("trackInterestTag") -- \$wma.trackInterest($req.param("trackInterestTag"))<br>
			$wma.trackInterest($req.param("trackInterestTag"))
		#end
		<h4>trackInterest(String interestTag) DOES NOT WORK</h4>

		<input onclick="$('trackInterestTag').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="trackInterestTag" id="trackInterestTag" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag1").length() > 0)
			$wma.adjustInterestScore($req.param("interestTag1"),$req.intParam("adjIntScore"))
		#end
		<h4>adjustInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag1').disabled = !(this.checked);$('adjIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag1" id="interestTag1" value="" disabled="disabled" type="text">
		Score: <input name="adjIntScore" id="adjIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("interestTag2").length() > 0)
		$wma.setInterestScore($req.param("interestTag2"),$req.intParam("setIntScore"))
		#end
		<h4>setInterestScore(String interestTag, int score)</h4>

		<input onclick="$('interestTag2').disabled = !(this.checked);$('setIntScore').disabled = !(this.checked)" type="checkbox">
		Interest Tag: <input name="interestTag2" id="interestTag2" value="" disabled="disabled" type="text">
		Score: <input name="setIntScore" id="setIntScore" value="5" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		#if($req.param("searchTerms","").length() > 0)
		$wma.trackSearch($req.param("searchTerms",""))
		#end
		<h4>trackSearch(String searchTerms)</h4>

		<input onclick="$('searchTerms').disabled = !(this.checked)" type="checkbox">
		Search Terms: <input name="searchTerms" id="searchTerms" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	
	<div class="customerWide">
		#if($req.param("actionTag","").length() > 0)
		$wma.trackVisitorAction($req.param("actionTag",""),$req.param("actionDesc",""))
		#end
		<h4>trackVisitorAction(String actionTag, String description)</h4>

		<input onclick="$('actionTag').disabled = !(this.checked);$('actionDesc').disabled = !(this.checked)" type="checkbox">
		Action Tag: <input name="actionTag" id="actionTag" value="" disabled="disabled" type="text">
		Desc: <input name="actionDesc" id="actionDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	
	<div class="customerWide">
		## $wma.trackCampaign(String campaignTag, String description)
		<h4>trackCampaign(String campaignTag, String description)</h4>
		<table border="1">
		<tr>
		<th>Campaign Name</th>
		<th>Campaign ID</th>
		<th>Start Date</th>
		<th>End Date</th>
		<th>Parameter Key</th>
		</tr>
		#foreach($campaign in $wma.campaignDefinitions)
		<tr>
		<td>$campaign.name</td>
		<td>$campaign.campaignId</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.startDate)</td>
		<td>$!util.date("MM-dd-yyyy", $campaign.endDate)</td>
		<td>$campaign.paramKey</td>
		</tr>
		#end 
		</table><br>
		#if($req.param("trCamp").length() > 0)
			$wma.trackCampaign($req.param("trCamp"),$req.param("trCampDesc"))
		#end
		
		<input onclick="$('trCamp').disabled = !(this.checked); $('trCampDesc').disabled = !(this.checked)" type="checkbox">
		Campaign ID: <input name="trCamp" id="trCamp" value="" disabled="disabled" type="text">

		Desc: <input name="trCampDesc" id="trCampDesc" value="" disabled="disabled" type="text">
		<input value="submit" type="submit">
	</div>
	<div class="customerWide">
		<h4>wma.ruleDefinitions</h4>
		<table border="1">
		<tr>
		<th>Customer ID</th>
		<th>Rule Name</th>
		<th>Expression</th>
		<th>Rules</th>
		</tr>
		#foreach($rule in $wma.ruleDefinitions)
		<tr>
		<td>$rule.customerId</td>
		<td>$rule.ruleName</td>
		<td>$rule.logicalOperator.operationString ($rule.logicalOperator.operator)</td>
		<td>
		#foreach($ruleExpression in $rule.ruleExpressions)
			$ruleExpression.fieldName - $ruleExpression.expressionOperator.operationString ($ruleExpression.expressionOperator.operator)<br>
			#foreach($ruleValue in $ruleExpression.ruleExpressionValues)
				$ruleValue.ruleValueLabel<br>
			#end
			#if($velocityCount != $rule.ruleExpressions.size())
			<hr>
			#end
		#end
		</td>
		</tr>
		#end 
		</table><br>
	</div>
	
</form>	

</div>

$cms.template("Bottom")









